<div class="container specialty-page">
    <div class="sticky-header rounded">
        <div class="d-flex align-items-center gap-2 mb-3">
            <mat-icon (click)="navigateToDashboard()" class="cursor-pointer back-icon">
                arrow_back
            </mat-icon>
            <p class="fs-5 fw-semibold mb-0">Find a Specialty</p>
        </div>
    </div>
</div>

<div class="container">
    <div class="row px-1 ">
        <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" class="border-round pb-3"
            [(selectedIndex)]="tbidx">
            <mat-tab label="Available Specialities">

              <div class="pt-3">
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-label>Find Specialty</mat-label>
                    <mat-icon matPrefix class="me-2">search</mat-icon>
                    <input (input)="onSearchSpecialty($event)" matInput />
                </mat-form-field>
              </div>
                <div class="list-container mt-1">
                    @for (specialty of filteredSpecialtyList; track specialty.ID) {
                    <div (click)="openDoctorBySpecialty(specialty)" class="specialty-item">
                        <p class="mb-0">{{ specialty.SpecialtyName }}</p>
                    </div>
                    <mat-divider></mat-divider>
                    }
                </div>
            </mat-tab>
            <mat-tab label="Available Doctors">
                <div class="row g-3 mt-3">
                    @if (doctorsBySpecialty?.length > 0) {
                    @for (doctor of doctorsBySpecialty; track doctor.ID) {
                    <div class="col-12 col-sm-6 col-md-4 col-lg-3">
                        <div class="doctor-card position-relative">

                            <div class="experience-badge">{{ doctor.Experience }}+</div>

                            <div class="doctor-img">
                                @if (doctor._url) {
                                <img [src]="doctor._url" alt="Doctor" />
                                } @else {
                                <div class="fallback-img">
                                    <mat-icon>person</mat-icon>
                                </div>
                                }
                            </div>

                            <div class="doctor-info">
                                <p class="doctor-name">Dr. {{ doctor.Doctor }}</p>
                                <p class="doctor-specialty">{{ doctor.Specialty }}</p>

                                <div class="rating">
                                    <mat-icon class="star-icon">star</mat-icon>
                                    <span class="rating-value">{{ doctor.Rating }}</span>
                                </div>

                                <span class="slots-chip">
                                    {{ doctor.AvailableSlots }} slots available
                                </span>
                                <div class="py-2">
                                    <button (click)="bookAppointment(doctor)" class="bookButton">Book
                                        Appointment</button>
                                </div>
                            </div>

                        </div>
                    </div>
                    }

                    } @else {
                    <div class="col-12">
                        <div class="no-doctors">
                            <mat-icon>medical_information</mat-icon>
                            <p>No doctors available for the {{ selectedSpecialty }} specialty</p>
                        </div>
                    </div>

                    }
                </div>
            </mat-tab>
        </mat-tab-group>
    </div>
</div>